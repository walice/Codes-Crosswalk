select(Country, ISO3166.3, WB_Income_Group_Code, WB_Income_Group_Code2) %>%
filter(WB_Income_Group_Code != WB_Income_Group_Code2)
WB <- read_xls("CLASS.xls", skip = 4)
WB <- WB %>%
select(Economy, Code, Region, `Income group`, `Lending category`, Other) %>%
rename(Country = Economy, ISO3166.3 = Code, WB_Income_Group = `Income group`,
Lending_Category = `Lending category`, WB_Other = Other) %>%
filter(Country != "x")
WB$WB_Income_Group_Code2 <- NA
WB$WB_Income_Group_Code2 <- ifelse(WB$WB_Income_Group == "Low income", "LIC", WB$WB_Income_Group_Code2)
WB$WB_Income_Group_Code2 <- ifelse(WB$WB_Income_Group == "Lower middle income", "LMC", WB$WB_Income_Group_Code2)
WB$WB_Income_Group_Code2 <- ifelse(WB$WB_Income_Group == "Upper middle income", "UMC", WB$WB_Income_Group_Code2)
WB$WB_Income_Group_Code2 <- ifelse(WB$WB_Income_Group == "High income", "HIC", WB$WB_Income_Group_Code2)
no.group <- WB %>% filter(is.na(WB_Income_Group_Code2))
codes <- read_xlsx("Codes_Masterlist.xlsx", sheet = "Codes") %>%
mutate_all(as.character)
codes2 <- left_join(codes, WB %>% select(ISO3166.3, Lending_Category, WB_Other, WB_Income_Group_Code2),
by = c("ISO3166.3"))
test <- codes2 %>%
select(Country, ISO3166.3, WB_Income_Group_Code, WB_Income_Group_Code2) %>%
filter(WB_Income_Group_Code != WB_Income_Group_Code2)
View(test)
codes <- left_join(codes, WB %>% select(ISO3166.3, Lending_Category, WB_Other, WB_Income_Group_Code2),
by = c("ISO3166.3"))
codes %>% filter(codes$WB_Income_Group_Code != WB_Income_Group_Code2) %>% nrow
codes$WB_Income_Group_Code2 <- NULL
View(codes)
?read_xlsx
library("xlsx")
install.packages("xlsx")
library(xlsx)
?write.xlsx2
write.xlsx2(codes, "Codes-Masterlist2.xlsx")
write.xlsx2(codes, "Codes-Masterlist2.xlsx", row.names = F)
write.xlsx2(codes, "Codes-Masterlist2.xlsx", row.names = FALSE)
write.xlsx2(codes, "Codes-Masterlist2.xlsx", row.names = FALSE)
write.xlsx(codes, "Codes-Masterlist2.xlsx", row.names = FALSE)
write.xlsx(codes, "Codes-Masterlist2.xlsx")
write.xlsx(codes, "Codes-Masterlist2.xlsx", row.names = FALSE)
write.xlsx2(codes, "Codes-Masterlist2.xlsx", row.names = FALSE)
?write_excel_csv
library(openxlsx)
install.packages("openxlsx")
library(openxlsx)
?write.xlsx
library(tidyverse)
library(openxlsx)
# June 2018 classification
WB <- read_xls("CLASS.xls", skip = 4)
WB <- WB %>%
select(Economy, Code, Region, `Income group`, `Lending category`, Other) %>%
rename(Country = Economy, ISO3166.3 = Code, WB_Income_Group = `Income group`,
Lending_Category = `Lending category`, WB_Other = Other) %>%
filter(Country != "x")
WB$WB_Income_Group_Code2 <- NA
WB$WB_Income_Group_Code2 <- ifelse(WB$WB_Income_Group == "Low income", "LIC", WB$WB_Income_Group_Code2)
WB$WB_Income_Group_Code2 <- ifelse(WB$WB_Income_Group == "Lower middle income", "LMC", WB$WB_Income_Group_Code2)
WB$WB_Income_Group_Code2 <- ifelse(WB$WB_Income_Group == "Upper middle income", "UMC", WB$WB_Income_Group_Code2)
WB$WB_Income_Group_Code2 <- ifelse(WB$WB_Income_Group == "High income", "HIC", WB$WB_Income_Group_Code2)
no.group <- WB %>% filter(is.na(WB_Income_Group_Code2))
codes <- read_xlsx("Codes_Masterlist.xlsx", sheet = "Codes") %>%
mutate_all(as.character)
codes <- left_join(codes, WB %>% select(ISO3166.3, Lending_Category, WB_Other, WB_Income_Group_Code2),
by = c("ISO3166.3"))
codes %>% filter(codes$WB_Income_Group_Code != WB_Income_Group_Code2) %>% nrow
codes$WB_Income_Group_Code2 <- NULL
write.xlsx2(codes, "Codes-Masterlist2.xlsx")
write.xlsx2(codes, "Codes-Masterlist2.xlsx", row.names = F)
write.xlsx2(codes, "Codes-Masterlist2.xlsx", rowNames = F)
write.xlsx2(codes, "Codes-Masterlist2.xlsx", rowNames = F)
row.names(codes) <- NULL
write.xlsx2(codes, "Codes-Masterlist2.xlsx")
View(codes)
row.names(codes) <- NULL
write.xlsx(codes, "Codes-Masterlist2.xlsx")
setwd("C:/boxsync/alepissier/PhD/Software/Codes-Masterlist")
library(tidyverse)
library(openxlsx)
# June 2018 classification
WB <- read_xls("CLASS.xls", skip = 4)
WB <- WB %>%
select(Economy, Code, Region, `Income group`, `Lending category`, Other) %>%
rename(Country = Economy, ISO3166.3 = Code, WB_Income_Group = `Income group`,
Lending_Category = `Lending category`, WB_Other = Other) %>%
filter(Country != "x")
WB$WB_Income_Group_Code2 <- NA
WB$WB_Income_Group_Code2 <- ifelse(WB$WB_Income_Group == "Low income", "LIC", WB$WB_Income_Group_Code2)
WB$WB_Income_Group_Code2 <- ifelse(WB$WB_Income_Group == "Lower middle income", "LMC", WB$WB_Income_Group_Code2)
WB$WB_Income_Group_Code2 <- ifelse(WB$WB_Income_Group == "Upper middle income", "UMC", WB$WB_Income_Group_Code2)
WB$WB_Income_Group_Code2 <- ifelse(WB$WB_Income_Group == "High income", "HIC", WB$WB_Income_Group_Code2)
no.group <- WB %>% filter(is.na(WB_Income_Group_Code2))
setwd("C:/boxsync/alepissier/PhD/Software/Codes-Masterlist")
library(tidyverse)
library(openxlsx)
# June 2018 classification
WB <- read_xls("CLASS.xls", skip = 4)
setwd("C:/boxsync/alepissier/PhD/Software/Codes-Masterlist")
library(tidyverse)
library(openxlsx)
# June 2018 classification
WB <- read_xls("CLASS.xls", skip = 4)
??read_xls
library(readxl)
library(openxlsx)
# June 2018 classification
WB <- read_xls("CLASS.xls", skip = 4)
WB <- WB %>%
select(Economy, Code, Region, `Income group`, `Lending category`, Other) %>%
rename(Country = Economy, ISO3166.3 = Code, WB_Income_Group = `Income group`,
Lending_Category = `Lending category`, WB_Other = Other) %>%
filter(Country != "x")
WB$WB_Income_Group_Code2 <- NA
WB$WB_Income_Group_Code2 <- ifelse(WB$WB_Income_Group == "Low income", "LIC", WB$WB_Income_Group_Code2)
WB$WB_Income_Group_Code2 <- ifelse(WB$WB_Income_Group == "Lower middle income", "LMC", WB$WB_Income_Group_Code2)
WB$WB_Income_Group_Code2 <- ifelse(WB$WB_Income_Group == "Upper middle income", "UMC", WB$WB_Income_Group_Code2)
WB$WB_Income_Group_Code2 <- ifelse(WB$WB_Income_Group == "High income", "HIC", WB$WB_Income_Group_Code2)
no.group <- WB %>% filter(is.na(WB_Income_Group_Code2))
codes <- read_xlsx("Codes_Masterlist.xlsx", sheet = "Codes") %>%
mutate_all(as.character)
codes <- left_join(codes, WB %>% select(ISO3166.3, Lending_Category, WB_Other, WB_Income_Group_Code2),
by = c("ISO3166.3"))
codes %>% filter(codes$WB_Income_Group_Code != WB_Income_Group_Code2) %>% nrow
codes$WB_Income_Group_Code2 <- NULL
hs <- createStyle(textDecoration = "Bold")
write.xlsx(codes, "Codes-Masterlist2.xlsx", headerStyle = hs)
#setwd("C:/Users/Alice/Box Sync/PhD/Software/Codes-Masterlist") # Laptop
setwd("C:/boxsync/alepissier/PhD/Software/Codes-Masterlist") # Bren
library(tidyverse)
library(readxl)
#library(xlsx)
library(openxlsx)
# Import three sheets
codes <- read_xlsx("Codes_Masterlist.xlsx", sheet = "Codes") %>%
mutate_all(as.character)
regional <- read_xlsx("Codes_Masterlist.xlsx",
sheet = "UN_Regional_Groupings") %>%
mutate_all(as.character)
wb <- read_xlsx("Codes_Masterlist.xlsx",
sheet = "World_Bank_Groupings") %>%
mutate_all(as.character)
# June 2018 classification
WB <- read_xls("CLASS.xls", skip = 4)
WB <- WB %>%
select(Economy, Code, Region, `Income group`, `Lending category`, Other) %>%
rename(Country = Economy, ISO3166.3 = Code, WB_Income_Group = `Income group`,
Lending_Category = `Lending category`, WB_Other = Other) %>%
filter(Country != "x")
WB$WB_Income_Group_Code2 <- NA
WB$WB_Income_Group_Code2 <- ifelse(WB$WB_Income_Group == "Low income", "LIC", WB$WB_Income_Group_Code2)
WB$WB_Income_Group_Code2 <- ifelse(WB$WB_Income_Group == "Lower middle income", "LMC", WB$WB_Income_Group_Code2)
WB$WB_Income_Group_Code2 <- ifelse(WB$WB_Income_Group == "Upper middle income", "UMC", WB$WB_Income_Group_Code2)
WB$WB_Income_Group_Code2 <- ifelse(WB$WB_Income_Group == "High income", "HIC", WB$WB_Income_Group_Code2)
no.group <- WB %>% filter(is.na(WB_Income_Group_Code2))
codes <- left_join(codes, WB %>% select(ISO3166.3, Lending_Category, WB_Other, WB_Income_Group_Code2),
by = c("ISO3166.3"))
codes %>% filter(codes$WB_Income_Group_Code != WB_Income_Group_Code2) %>% nrow
codes$WB_Income_Group_Code2 <- NULL
book <- createWorkbook()
addWorksheet(book, "Codes")
writeData(book, sheet = "Codes", x = codes)
addWorksheet(book, "UN_Regional_Groupings")
writeData(book, sheet = "UN_Regional_Groupings", x = regional)
addWorksheet(book, "World_Bank_Groupings")
hs <- createStyle(textDecoration = "Bold")
write.xlsx(book, "Codes-Masterlist2.xlsx", headerStyle = hs)
writeDataTable(book, sheet = "World_Bank_Groupings", x = wb) ## write is a a Excel table
setwd("C:/Users/Alice/Box Sync/PhD/Software/Codes-Masterlist") # Laptop
#setwd("C:/boxsync/alepissier/PhD/Software/Codes-Masterlist") # Bren
library(tidyverse)
library(readxl)
#library(xlsx)
library(openxlsx)
# Import three sheets
codes <- read_xlsx("Codes_Masterlist.xlsx", sheet = "Codes") %>%
mutate_all(as.character)
regional <- read_xlsx("Codes_Masterlist.xlsx",
sheet = "UN_Regional_Groupings") %>%
mutate_all(as.character)
wb <- read_xlsx("Codes_Masterlist.xlsx",
sheet = "World_Bank_Groupings") %>%
mutate_all(as.character)
# June 2018 classification
WB <- read_xls("CLASS.xls", skip = 4)
WB <- WB %>%
select(Economy, Code, Region, `Income group`, `Lending category`, Other) %>%
rename(Country = Economy, ISO3166.3 = Code, WB_Income_Group = `Income group`,
Lending_Category = `Lending category`, WB_Other = Other) %>%
filter(Country != "x")
WB$WB_Income_Group_Code2 <- NA
WB$WB_Income_Group_Code2 <- ifelse(WB$WB_Income_Group == "Low income", "LIC", WB$WB_Income_Group_Code2)
WB$WB_Income_Group_Code2 <- ifelse(WB$WB_Income_Group == "Lower middle income", "LMC", WB$WB_Income_Group_Code2)
WB$WB_Income_Group_Code2 <- ifelse(WB$WB_Income_Group == "Upper middle income", "UMC", WB$WB_Income_Group_Code2)
WB$WB_Income_Group_Code2 <- ifelse(WB$WB_Income_Group == "High income", "HIC", WB$WB_Income_Group_Code2)
no.group <- WB %>% filter(is.na(WB_Income_Group_Code2))
codes <- left_join(codes, WB %>% select(ISO3166.3, Lending_Category, WB_Other, WB_Income_Group_Code2),
by = c("ISO3166.3"))
codes %>% filter(codes$WB_Income_Group_Code != WB_Income_Group_Code2) %>% nrow
codes$WB_Income_Group_Code2 <- NULL
book <- createWorkbook()
hs <- createStyle(textDecoration = "Bold")
addWorksheet(book, "Codes")
writeData(book, sheet = "Codes", x = codes, headerStyle = hs)
addWorksheet(book, "UN_Regional_Groupings")
writeData(book, sheet = "UN_Regional_Groupings", x = regional, headerStyle = hs)
addWorksheet(book, "World_Bank_Groupings")
writeData(book, sheet = "World_Bank_Groupings", x = wb, headerStyle = hs) ## write is a a Excel table
write.xlsx(book, "Codes-Masterlist2.xlsx", headerStyle = hs)
saveWorkbook(book, "Codes-Masterlist2.xlsx", overwrite = TRUE)
?setColWidths
setColWidths(book, cols = 1:20, widths = "auto")
ncol(codes)
setColWidths(book, sheet = "Codes", cols = ncol(codes), widths = "auto")
saveWorkbook(book, "Codes-Masterlist2.xlsx", overwrite = TRUE)
setColWidths(book, sheet = "Codes", cols = 1:ncol(codes), widths = "auto")
book <- createWorkbook()
hs <- createStyle(textDecoration = "Bold")
addWorksheet(book, "Codes")
writeData(book, sheet = "Codes", x = codes, headerStyle = hs)
addWorksheet(book, "UN_Regional_Groupings")
writeData(book, sheet = "UN_Regional_Groupings", x = regional, headerStyle = hs)
addWorksheet(book, "World_Bank_Groupings")
writeData(book, sheet = "World_Bank_Groupings", x = wb, headerStyle = hs)
setColWidths(book, sheet = "Codes", cols = 1:ncol(codes), widths = "auto")
saveWorkbook(book, "Codes-Masterlist2.xlsx", overwrite = TRUE)
ncol(codes)
book <- createWorkbook()
hs <- createStyle(textDecoration = "Bold")
addWorksheet(book, "Codes")
writeData(book, sheet = "Codes", x = codes, headerStyle = hs)
addWorksheet(book, "UN_Regional_Groupings")
writeData(book, sheet = "UN_Regional_Groupings", x = regional, headerStyle = hs)
addWorksheet(book, "World_Bank_Groupings")
writeData(book, sheet = "World_Bank_Groupings", x = wb, headerStyle = hs)
setColWidths(book, sheet = "Codes", cols = 1:ncol(codes), widths = "auto")
setColWidths(book, sheet = "UN_Regional_Groupings", cols = 1:ncol(regional), widths = "auto")
setColWidths(book, sheet = "World_Bank_Groupings", cols = 1:ncol(wb), widths = "auto")
saveWorkbook(book, "Codes-Masterlist2.xlsx", overwrite = TRUE)
#setwd("C:/Users/Alice/Box Sync/PhD/Software/Codes-Masterlist") # Laptop
setwd("C:/boxsync/alepissier/PhD/Software/Codes-Masterlist") # Bren
library(tidyverse)
library(readxl)
#library(xlsx)
library(openxlsx)
# Import three sheets
codes <- read_xlsx("Codes_Masterlist.xlsx", sheet = "Codes")
regional <- read_xlsx("Codes_Masterlist.xlsx",
sheet = "UN_Regional_Groupings")
wb <- read_xlsx("Codes_Masterlist.xlsx",
sheet = "World_Bank_Groupings")
# June 2018 classification
WB <- read_xls("CLASS.xls", skip = 4)
WB <- WB %>%
select(Economy, Code, Region, `Income group`, `Lending category`, Other) %>%
rename(Country = Economy, ISO3166.3 = Code, WB_Income_Group = `Income group`,
Lending_Category = `Lending category`, WB_Other = Other) %>%
filter(Country != "x")
WB$WB_Income_Group_Code2 <- NA
WB$WB_Income_Group_Code2 <- ifelse(WB$WB_Income_Group == "Low income", "LIC", WB$WB_Income_Group_Code2)
WB$WB_Income_Group_Code2 <- ifelse(WB$WB_Income_Group == "Lower middle income", "LMC", WB$WB_Income_Group_Code2)
WB$WB_Income_Group_Code2 <- ifelse(WB$WB_Income_Group == "Upper middle income", "UMC", WB$WB_Income_Group_Code2)
WB$WB_Income_Group_Code2 <- ifelse(WB$WB_Income_Group == "High income", "HIC", WB$WB_Income_Group_Code2)
no.group <- WB %>% filter(is.na(WB_Income_Group_Code2))
codes <- left_join(codes, WB %>% select(ISO3166.3, Lending_Category, WB_Other, WB_Income_Group_Code2),
by = c("ISO3166.3"))
codes %>% filter(codes$WB_Income_Group_Code != WB_Income_Group_Code2) %>% nrow
codes$WB_Income_Group_Code2 <- NULL
book <- createWorkbook()
hs <- createStyle(textDecoration = "Bold")
addWorksheet(book, "Codes")
writeData(book, sheet = "Codes", x = codes, headerStyle = hs)
addWorksheet(book, "UN_Regional_Groupings")
writeData(book, sheet = "UN_Regional_Groupings", x = regional, headerStyle = hs)
addWorksheet(book, "World_Bank_Groupings")
writeData(book, sheet = "World_Bank_Groupings", x = wb, headerStyle = hs)
setColWidths(book, sheet = "Codes", cols = 1:ncol(codes), widths = "auto")
setColWidths(book, sheet = "UN_Regional_Groupings", cols = 1:ncol(regional), widths = "auto")
setColWidths(book, sheet = "World_Bank_Groupings", cols = 1:ncol(wb), widths = "auto")
saveWorkbook(book, "Codes-Masterlist2.xlsx", overwrite = TRUE)
#setwd("C:/Users/Alice/Box Sync/PhD/Software/Codes-Masterlist") # Laptop
setwd("C:/boxsync/alepissier/PhD/Software/Codes-Masterlist") # Bren
library(tidyverse)
library(readxl)
#library(xlsx)
library(openxlsx)
# Import three sheets
codes <- read_xlsx("Codes_Masterlist.xlsx", sheet = "Codes")
regional <- read_xlsx("Codes_Masterlist.xlsx",
sheet = "UN_Regional_Groupings")
wb <- read_xlsx("Codes_Masterlist.xlsx",
sheet = "World_Bank_Groupings")
# June 2018 classification
WB <- read_xls("CLASS.xls", skip = 4)
WB <- WB %>%
select(Economy, Code, Region, `Income group`, `Lending category`, Other) %>%
rename(Country = Economy, ISO3166.3 = Code, WB_Income_Group = `Income group`,
WB_Lending_Category = `Lending category`, WB_Other = Other) %>%
filter(Country != "x")
WB$WB_Income_Group_Code2 <- NA
WB$WB_Income_Group_Code2 <- ifelse(WB$WB_Income_Group == "Low income", "LIC", WB$WB_Income_Group_Code2)
WB$WB_Income_Group_Code2 <- ifelse(WB$WB_Income_Group == "Lower middle income", "LMC", WB$WB_Income_Group_Code2)
WB$WB_Income_Group_Code2 <- ifelse(WB$WB_Income_Group == "Upper middle income", "UMC", WB$WB_Income_Group_Code2)
WB$WB_Income_Group_Code2 <- ifelse(WB$WB_Income_Group == "High income", "HIC", WB$WB_Income_Group_Code2)
no.group <- WB %>% filter(is.na(WB_Income_Group_Code2))
codes <- left_join(codes, WB %>% select(ISO3166.3, Lending_Category, WB_Other, WB_Income_Group_Code2),
by = c("ISO3166.3"))
codes %>% filter(codes$WB_Income_Group_Code != WB_Income_Group_Code2) %>% nrow
codes$WB_Income_Group_Code2 <- NULL
book <- createWorkbook()
hs <- createStyle(textDecoration = "Bold")
addWorksheet(book, "Codes")
writeData(book, sheet = "Codes", x = codes, headerStyle = hs)
addWorksheet(book, "UN_Regional_Groupings")
writeData(book, sheet = "UN_Regional_Groupings", x = regional, headerStyle = hs)
addWorksheet(book, "World_Bank_Groupings")
writeData(book, sheet = "World_Bank_Groupings", x = wb, headerStyle = hs)
setColWidths(book, sheet = "Codes", cols = 1:ncol(codes), widths = "auto")
setColWidths(book, sheet = "UN_Regional_Groupings", cols = 1:ncol(regional), widths = "auto")
setColWidths(book, sheet = "World_Bank_Groupings", cols = 1:ncol(wb), widths = "auto")
saveWorkbook(book, "Codes-Masterlist.xlsx", overwrite = TRUE)
#setwd("C:/Users/Alice/Box Sync/PhD/Software/Codes-Masterlist") # Laptop
setwd("C:/boxsync/alepissier/PhD/Software/Codes-Masterlist") # Bren
library(tidyverse)
library(readxl)
#library(xlsx)
library(openxlsx)
# Import three sheets
codes <- read_xlsx("Codes_Masterlist.xlsx", sheet = "Codes")
regional <- read_xlsx("Codes_Masterlist.xlsx",
sheet = "UN_Regional_Groupings")
wb <- read_xlsx("Codes_Masterlist.xlsx",
sheet = "World_Bank_Groupings")
# June 2018 classification
WB <- read_xls("CLASS.xls", skip = 4)
WB <- WB %>%
select(Economy, Code, Region, `Income group`, `Lending category`, Other) %>%
rename(Country = Economy, ISO3166.3 = Code, WB_Income_Group = `Income group`,
WB_Lending_Category = `Lending category`, WB_Other = Other) %>%
filter(Country != "x")
WB$WB_Income_Group_Code2 <- NA
WB$WB_Income_Group_Code2 <- ifelse(WB$WB_Income_Group == "Low income", "LIC", WB$WB_Income_Group_Code2)
WB$WB_Income_Group_Code2 <- ifelse(WB$WB_Income_Group == "Lower middle income", "LMC", WB$WB_Income_Group_Code2)
WB$WB_Income_Group_Code2 <- ifelse(WB$WB_Income_Group == "Upper middle income", "UMC", WB$WB_Income_Group_Code2)
WB$WB_Income_Group_Code2 <- ifelse(WB$WB_Income_Group == "High income", "HIC", WB$WB_Income_Group_Code2)
no.group <- WB %>% filter(is.na(WB_Income_Group_Code2))
codes <- left_join(codes, WB %>% select(ISO3166.3, WB_Lending_Category, WB_Other, WB_Income_Group_Code2),
by = c("ISO3166.3"))
codes %>% filter(codes$WB_Income_Group_Code != WB_Income_Group_Code2) %>% nrow
codes$WB_Income_Group_Code2 <- NULL
book <- createWorkbook()
hs <- createStyle(textDecoration = "Bold")
addWorksheet(book, "Codes")
writeData(book, sheet = "Codes", x = codes, headerStyle = hs)
addWorksheet(book, "UN_Regional_Groupings")
writeData(book, sheet = "UN_Regional_Groupings", x = regional, headerStyle = hs)
addWorksheet(book, "World_Bank_Groupings")
writeData(book, sheet = "World_Bank_Groupings", x = wb, headerStyle = hs)
setColWidths(book, sheet = "Codes", cols = 1:ncol(codes), widths = "auto")
setColWidths(book, sheet = "UN_Regional_Groupings", cols = 1:ncol(regional), widths = "auto")
setColWidths(book, sheet = "World_Bank_Groupings", cols = 1:ncol(wb), widths = "auto")
saveWorkbook(book, "Codes-Masterlist.xlsx", overwrite = TRUE)
#setwd("C:/Users/Alice/Box Sync/PhD/Software/Codes-Masterlist") # Laptop
setwd("C:/boxsync/alepissier/PhD/Software/Codes-Masterlist") # Bren
library(tidyverse)
library(readxl)
#library(xlsx)
library(openxlsx)
# Import three sheets
codes <- read_xlsx("Codes_Masterlist.xlsx", sheet = "Codes")
regional <- read_xlsx("Codes_Masterlist.xlsx",
sheet = "UN_Regional_Groupings")
wb <- read_xlsx("Codes_Masterlist.xlsx",
sheet = "World_Bank_Groupings")
# June 2018 classification
WB <- read_xls("CLASS.xls", skip = 4)
WB <- WB %>%
select(Economy, Code, Region, `Income group`, `Lending category`, Other) %>%
rename(Country = Economy, ISO3166.3 = Code, WB_Income_Group = `Income group`,
WB_Lending_Category = `Lending category`, WB_Other = Other) %>%
filter(Country != "x")
WB$WB_Income_Group_Code2 <- NA
WB$WB_Income_Group_Code2 <- ifelse(WB$WB_Income_Group == "Low income", "LIC", WB$WB_Income_Group_Code2)
WB$WB_Income_Group_Code2 <- ifelse(WB$WB_Income_Group == "Lower middle income", "LMC", WB$WB_Income_Group_Code2)
WB$WB_Income_Group_Code2 <- ifelse(WB$WB_Income_Group == "Upper middle income", "UMC", WB$WB_Income_Group_Code2)
WB$WB_Income_Group_Code2 <- ifelse(WB$WB_Income_Group == "High income", "HIC", WB$WB_Income_Group_Code2)
no.group <- WB %>% filter(is.na(WB_Income_Group_Code2))
codes <- left_join(codes, WB %>% select(ISO3166.3, WB_Lending_Category, WB_Other, WB_Income_Group_Code2),
by = c("ISO3166.3"))
codes %>% filter(codes$WB_Income_Group_Code != WB_Income_Group_Code2) %>% nrow
codes$WB_Income_Group_Code2 <- NULL
book <- createWorkbook()
hs <- createStyle(textDecoration = "Bold")
addWorksheet(book, "Codes")
writeData(book, sheet = "Codes", x = codes, headerStyle = hs)
addWorksheet(book, "UN_Regional_Groupings")
writeData(book, sheet = "UN_Regional_Groupings", x = regional, headerStyle = hs)
addWorksheet(book, "World_Bank_Groupings")
writeData(book, sheet = "World_Bank_Groupings", x = wb, headerStyle = hs)
setColWidths(book, sheet = "Codes", cols = 1:ncol(codes), widths = "auto")
setColWidths(book, sheet = "UN_Regional_Groupings", cols = 1:ncol(regional), widths = "auto")
setColWidths(book, sheet = "World_Bank_Groupings", cols = 1:ncol(wb), widths = "auto")
saveWorkbook(book, "Codes-Masterlist.xlsx", overwrite = TRUE)
#setwd("C:/Users/Alice/Box Sync/PhD/Software/Codes-Masterlist") # Laptop
setwd("C:/boxsync/alepissier/PhD/Software/Codes-Masterlist") # Bren
library(tidyverse)
library(readxl)
#library(xlsx)
library(openxlsx)
# Import three sheets
codes <- read_xlsx("Codes_Masterlist.xlsx", sheet = "Codes")
regional <- read_xlsx("Codes_Masterlist.xlsx",
sheet = "UN_Regional_Groupings")
wb <- read_xlsx("Codes_Masterlist.xlsx",
sheet = "World_Bank_Groupings")
# June 2018 classification
WB <- read_xls("CLASS.xls", skip = 4)
WB <- WB %>%
select(Economy, Code, Region, `Income group`, `Lending category`, Other) %>%
rename(Country = Economy, ISO3166.3 = Code, WB_Income_Group = `Income group`,
WB_Lending_Category = `Lending category`, WB_Other = Other) %>%
filter(Country != "x")
WB$WB_Income_Group_Code2 <- NA
WB$WB_Income_Group_Code2 <- ifelse(WB$WB_Income_Group == "Low income", "LIC", WB$WB_Income_Group_Code2)
WB$WB_Income_Group_Code2 <- ifelse(WB$WB_Income_Group == "Lower middle income", "LMC", WB$WB_Income_Group_Code2)
WB$WB_Income_Group_Code2 <- ifelse(WB$WB_Income_Group == "Upper middle income", "UMC", WB$WB_Income_Group_Code2)
WB$WB_Income_Group_Code2 <- ifelse(WB$WB_Income_Group == "High income", "HIC", WB$WB_Income_Group_Code2)
no.group <- WB %>% filter(is.na(WB_Income_Group_Code2))
codes <- left_join(codes, WB %>% select(ISO3166.3, WB_Lending_Category, WB_Other, WB_Income_Group_Code2),
by = c("ISO3166.3"))
codes %>% filter(codes$WB_Income_Group_Code != WB_Income_Group_Code2) %>% nrow
codes$WB_Income_Group_Code2 <- NULL
book <- createWorkbook()
hs <- createStyle(textDecoration = "Bold")
addWorksheet(book, "Codes")
writeData(book, sheet = "Codes", x = codes, headerStyle = hs)
addWorksheet(book, "UN_Regional_Groupings")
writeData(book, sheet = "UN_Regional_Groupings", x = regional, headerStyle = hs)
addWorksheet(book, "World_Bank_Groupings")
writeData(book, sheet = "World_Bank_Groupings", x = wb, headerStyle = hs)
setColWidths(book, sheet = "Codes", cols = 1:ncol(codes), widths = "auto")
setColWidths(book, sheet = "UN_Regional_Groupings", cols = 1:ncol(regional), widths = "auto")
setColWidths(book, sheet = "World_Bank_Groupings", cols = 1:ncol(wb), widths = "auto")
saveWorkbook(book, "Codes-Masterlist.xlsx", overwrite = TRUE)
#setwd("C:/Users/Alice/Box Sync/PhD/Software/Codes-Masterlist") # Laptop
setwd("C:/boxsync/alepissier/PhD/Software/Codes-Masterlist") # Bren
library(tidyverse)
library(readxl)
#library(xlsx)
library(openxlsx)
#setwd("C:/Users/Alice/Box Sync/PhD/Software/Codes-Masterlist") # Laptop
setwd("C:/boxsync/alepissier/PhD/Software/Codes-Masterlist") # Bren
library(openxlsx)
library(tidyverse)
library(readxl)
# Import three sheets
codes <- read_xlsx("Codes_Masterlist.xlsx", sheet = "Codes")
regional <- read_xlsx("Codes_Masterlist.xlsx",
sheet = "UN_Regional_Groupings")
"
#setwd("C:/Users/Alice/Box Sync/PhD/Software/Codes-Masterlist") # Laptop
setwd("C:/boxsync/alepissier/PhD/Software/Codes-Masterlist") # Bren
#setwd("C:/Users/Alice/Box Sync/PhD/Software/Codes-Masterlist") # Laptop
setwd("C:/boxsync/alepissier/PhD/Software/Codes-Masterlist") # Bren
# Import three sheets
codes <- read_xlsx("Codes_Masterlist.xlsx", sheet = "Codes")
regional <- read_xlsx("Codes_Masterlist.xlsx",
sheet = "UN_Regional_Groupings")
#setwd("C:/Users/Alice/Box Sync/PhD/Software/Codes-Masterlist") # Laptop
setwd("C:/boxsync/alepissier/PhD/Software/Codes-Masterlist") # Bren
# Import three sheets
codes <- read_xlsx("Codes_Masterlist.xlsx", sheet = "Codes")
#setwd("C:/Users/Alice/Box Sync/PhD/Software/Codes-Masterlist") # Laptop
setwd("C:/boxsync/alepissier/PhD/Software/Codes-Masterlist") # Bren
library(openxlsx)
library(tidyverse)
library(readxl)
# Import three sheets
codes <- read_xlsx("Codes_Masterlist.xlsx", sheet = "Codes")
# Import three sheets
codes <- read_xlsx("Codes_Masterlist.xlsx", sheet = "Codes")
regional <- read_xlsx("Codes_Masterlist.xlsx",
sheet = "UN_Regional_Groupings")
wb <- read_xlsx("Codes_Masterlist.xlsx",
sheet = "World_Bank_Groupings")
# June 2018 classification
WB <- read_xls("CLASS.xls", skip = 4)
WB <- WB %>%
select(Economy, Code, Region, `Income group`, `Lending category`, Other) %>%
rename(Country = Economy, ISO3166.3 = Code, WB_Income_Group = `Income group`,
WB_Lending_Category = `Lending category`, WB_Other = Other) %>%
filter(Country != "x")
WB$WB_Income_Group_Code2 <- NA
WB$WB_Income_Group_Code2 <- ifelse(WB$WB_Income_Group == "Low income", "LIC", WB$WB_Income_Group_Code2)
WB$WB_Income_Group_Code2 <- ifelse(WB$WB_Income_Group == "Lower middle income", "LMC", WB$WB_Income_Group_Code2)
WB$WB_Income_Group_Code2 <- ifelse(WB$WB_Income_Group == "Upper middle income", "UMC", WB$WB_Income_Group_Code2)
WB$WB_Income_Group_Code2 <- ifelse(WB$WB_Income_Group == "High income", "HIC", WB$WB_Income_Group_Code2)
no.group <- WB %>% filter(is.na(WB_Income_Group_Code2))
codes <- left_join(codes, WB %>% select(ISO3166.3, WB_Lending_Category, WB_Other, WB_Income_Group_Code2),
by = c("ISO3166.3"))
codes %>% filter(codes$WB_Income_Group_Code != WB_Income_Group_Code2) %>% nrow
codes$WB_Income_Group_Code2 <- NULL
book <- createWorkbook()
hs <- createStyle(textDecoration = "Bold")
addWorksheet(book, "Codes")
writeData(book, sheet = "Codes", x = codes, headerStyle = hs)
addWorksheet(book, "UN_Regional_Groupings")
writeData(book, sheet = "UN_Regional_Groupings", x = regional, headerStyle = hs)
addWorksheet(book, "World_Bank_Groupings")
writeData(book, sheet = "World_Bank_Groupings", x = wb, headerStyle = hs)
setColWidths(book, sheet = "Codes", cols = 1:ncol(codes), widths = "auto")
setColWidths(book, sheet = "UN_Regional_Groupings", cols = 1:ncol(regional), widths = "auto")
setColWidths(book, sheet = "World_Bank_Groupings", cols = 1:ncol(wb), widths = "auto")
saveWorkbook(book, "Codes_Masterlist.xlsx", overwrite = TRUE)
